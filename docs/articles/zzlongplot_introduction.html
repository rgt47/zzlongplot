<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>zzlongplot: A Flexible Framework for Longitudinal Data Visualization • zzlongplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="zzlongplot: A Flexible Framework for Longitudinal Data Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">zzlongplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.1000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/zzlongplot_introduction.html">zzlongplot: A Flexible Framework for Longitudinal Data Visualization</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rgt47/zzlongplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>zzlongplot: A Flexible Framework for Longitudinal Data Visualization</h1>
                        <h4 data-toc-skip class="author">Ronald (Ryy) G.
Thomas</h4>
            
            <h4 data-toc-skip class="date">2025-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rgt47/zzlongplot/blob/HEAD/vignettes/zzlongplot_introduction.Rmd" class="external-link"><code>vignettes/zzlongplot_introduction.Rmd</code></a></small>
      <div class="d-none name"><code>zzlongplot_introduction.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Longitudinal data visualization presents unique challenges that
require specialized plotting solutions. The <code>zzlongplot</code>
package addresses these challenges by providing a comprehensive,
flexible framework for creating publication-quality visualizations of
longitudinal data in R. Whether you’re conducting clinical trials,
educational assessments, or any research with repeated measurements over
time, <code>zzlongplot</code> offers intuitive functions that streamline
the creation of both observed value plots and change-from-baseline
visualizations.</p>
<div class="section level3">
<h3 id="the-challenge-of-longitudinal-data-visualization">The Challenge of Longitudinal Data Visualization<a class="anchor" aria-label="anchor" href="#the-challenge-of-longitudinal-data-visualization"></a>
</h3>
<p>Researchers working with longitudinal data typically need to answer
two fundamental questions:</p>
<ol style="list-style-type: decimal">
<li>How do measurements change over time?</li>
<li>How do these changes differ between groups or conditions?</li>
</ol>
<p>To address these questions effectively, visualizations must:</p>
<ul>
<li>Display observed values at each time point</li>
<li>Show changes relative to baseline measures</li>
<li>Represent uncertainty appropriately</li>
<li>Allow comparisons across different groups</li>
<li>Accommodate both continuous time points (e.g., days, years) and
categorical time points (e.g., “baseline”, “month1”, “month2”)</li>
<li>Support faceting to explore interactions with additional
variables</li>
</ul>
<p>While base R graphics and packages like <code>ggplot2</code> provide
powerful visualization capabilities, creating consistent,
publication-ready longitudinal plots often requires extensive custom
code. <code>zzlongplot</code> fills this gap by offering a specialized
suite of functions designed specifically for longitudinal data
visualization.</p>
</div>
<div class="section level3">
<h3 id="key-features-of-zzlongplot">Key Features of zzlongplot<a class="anchor" aria-label="anchor" href="#key-features-of-zzlongplot"></a>
</h3>
<p>The <code>zzlongplot</code> package offers several advantages for
researchers working with longitudinal data:</p>
<div class="section level4">
<h4 id="flexible-data-structure-support">1. Flexible Data Structure Support<a class="anchor" aria-label="anchor" href="#flexible-data-structure-support"></a>
</h4>
<ul>
<li>Works with both continuous and categorical time variables</li>
<li>Handles both balanced and unbalanced designs</li>
<li>Supports grouped data for comparing different conditions</li>
<li>Allows for flexible specification of baseline values</li>
</ul>
</div>
<div class="section level4">
<h4 id="comprehensive-visualization-options">2. Comprehensive Visualization Options<a class="anchor" aria-label="anchor" href="#comprehensive-visualization-options"></a>
</h4>
<ul>
<li>Generate observed value plots showing raw measurements over
time</li>
<li>Create change-from-baseline plots highlighting differences from
starting points</li>
<li>Combine both plot types side-by-side for comprehensive
reporting</li>
<li>Customize axis labels, titles, and other plot elements</li>
</ul>
</div>
<div class="section level4">
<h4 id="statistical-representation-choices">3. Statistical Representation Choices<a class="anchor" aria-label="anchor" href="#statistical-representation-choices"></a>
</h4>
<ul>
<li>Visualize uncertainty with either error bars or confidence
ribbons</li>
<li>Automatically calculate and display standard errors</li>
<li>Handle within-subject clustering for more accurate error
estimation</li>
</ul>
</div>
<div class="section level4">
<h4 id="formula-based-interface">4. Formula-Based Interface<a class="anchor" aria-label="anchor" href="#formula-based-interface"></a>
</h4>
<p><code>zzlongplot</code> employs a formula-based interface similar to
those used in statistical modeling functions, making it intuitive for R
users:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic usage</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With faceting</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">group</span>, facet_form <span class="op">=</span> <span class="va">facet_y</span> <span class="op">~</span> <span class="va">facet_x</span><span class="op">)</span></span></code></pre></div>
<p>This consistent syntax provides a familiar experience while offering
substantial flexibility.</p>
</div>
<div class="section level4">
<h4 id="integrated-theming-and-styling">5. Integrated Theming and Styling<a class="anchor" aria-label="anchor" href="#integrated-theming-and-styling"></a>
</h4>
<ul>
<li>Built-in support for colorblind-friendly palettes</li>
<li>Consistent, publication-ready styling defaults</li>
<li>Easy customization for specific journal requirements</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="package-architecture">Package Architecture<a class="anchor" aria-label="anchor" href="#package-architecture"></a>
</h3>
<p>The <code>zzlongplot</code> package consists of several core
functions:</p>
<ul>
<li>
<code><a href="../reference/lplot.html">lplot()</a></code>: The main user-facing function that creates
longitudinal plots</li>
<li>
<code><a href="../reference/parse_formula.html">parse_formula()</a></code>: Processes the formula notation that
specifies the plotting variables</li>
<li>
<code><a href="../reference/compute_stats.html">compute_stats()</a></code>: Calculates summary statistics for
different groups and time points</li>
<li>
<code><a href="../reference/generate_plot.html">generate_plot()</a></code>: Creates the actual visualizations
using ggplot2</li>
<li>
<code><a href="../reference/get_colorblind_palette.html">get_colorblind_palette()</a></code>: Provides accessible color
schemes for plots</li>
</ul>
<p>These functions work together to deliver a streamlined workflow for
creating sophisticated longitudinal visualizations with minimal
code.</p>
</div>
</div>
<div class="section level2">
<h2 id="getting-started-with-zzlongplot">Getting Started with zzlongplot<a class="anchor" aria-label="anchor" href="#getting-started-with-zzlongplot"></a>
</h2>
<p>Let’s begin by creating a sample dataset with longitudinal
measurements that we’ll use throughout this vignette.</p>
<div class="section level3">
<h3 id="creating-sample-data">Creating Sample Data<a class="anchor" aria-label="anchor" href="#creating-sample-data"></a>
</h3>
<p>First, we’ll create a dataset with continuous time points:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create sample data with continuous time points</span></span>
<span><span class="va">continuous_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  subject_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  visit_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,  <span class="co"># Weeks from baseline</span></span>
<span>  outcome <span class="op">=</span> <span class="cn">NA</span>,  <span class="co"># Will fill this with simulated data</span></span>
<span>  group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment"</span>, <span class="st">"Placebo"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate outcome data with treatment effect increasing over time</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">subject</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">continuous_data</span><span class="op">$</span><span class="va">subject_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">continuous_data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>  <span class="co"># Baseline value with some variation</span></span>
<span>  </span>
<span>  <span class="va">is_treatment</span> <span class="op">&lt;-</span> <span class="va">continuous_data</span><span class="op">$</span><span class="va">group</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Treatment"</span></span>
<span>  </span>
<span>  <span class="co"># Treatment effect increases over time, placebo has minimal effect</span></span>
<span>  <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">is_treatment</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">12</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Add individual trajectory with some random noise</span></span>
<span>  <span class="va">continuous_data</span><span class="op">$</span><span class="va">outcome</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">effect_size</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Look at the first few rows of our data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">continuous_data</span>, <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   subject_id visit_time  outcome     group</span></span>
<span><span class="co">#&gt; 1          1          0 46.50709 Treatment</span></span>
<span><span class="co">#&gt; 2          1          4 54.87375 Treatment</span></span>
<span><span class="co">#&gt; 3          1          8 54.40915   Placebo</span></span>
<span><span class="co">#&gt; 4          1         12 59.58548   Placebo</span></span>
<span><span class="co">#&gt; 5          2          0 59.95807 Treatment</span></span>
<span><span class="co">#&gt; 6          2          4 57.78014 Treatment</span></span>
<span><span class="co">#&gt; 7          2          8 63.51477   Placebo</span></span>
<span><span class="co">#&gt; 8          2         12 69.23834   Placebo</span></span></code></pre>
<p>Next, let’s create a dataset with categorical time points:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create sample data with categorical time points</span></span>
<span><span class="va">categorical_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  subject_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  visit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Baseline"</span>, <span class="st">"Month1"</span>, <span class="st">"Month3"</span>, <span class="st">"Month6"</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>  score <span class="op">=</span> <span class="cn">NA</span>,  <span class="co"># Will fill this with simulated data</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"Placebo"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">50</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Site 1"</span>, <span class="st">"Site 2"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>  <span class="co"># For faceting examples</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate score data with different treatment effects</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">subject</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">categorical_data</span><span class="op">$</span><span class="va">subject_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">categorical_data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fl">25</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>  <span class="co"># Baseline value</span></span>
<span>  </span>
<span>  <span class="co"># Different effects for different treatments</span></span>
<span>  <span class="va">treatment_type</span> <span class="op">&lt;-</span> <span class="va">categorical_data</span><span class="op">$</span><span class="va">treatment</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">treatment_type</span> <span class="op">==</span> <span class="st">"Drug A"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">10</span><span class="op">)</span>  <span class="co"># Strong effect</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">treatment_type</span> <span class="op">==</span> <span class="st">"Drug B"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>   <span class="co"># Moderate effect</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>   <span class="co"># Weak effect (placebo)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Add individual trajectory with some random noise</span></span>
<span>  <span class="va">categorical_data</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">baseline</span> <span class="op">+</span> <span class="va">effect_size</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Look at the first few rows of our data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">categorical_data</span>, <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   subject_id    visit    score treatment   site</span></span>
<span><span class="co">#&gt; 1          1 Baseline 22.74944    Drug A Site 1</span></span>
<span><span class="co">#&gt; 2          1   Month1 28.18536    Drug A Site 2</span></span>
<span><span class="co">#&gt; 3          1   Month3 32.05418    Drug A Site 1</span></span>
<span><span class="co">#&gt; 4          1   Month6 37.07021    Drug A Site 2</span></span>
<span><span class="co">#&gt; 5          2 Baseline 26.89590    Drug B Site 1</span></span>
<span><span class="co">#&gt; 6          2   Month1 29.99581    Drug B Site 2</span></span>
<span><span class="co">#&gt; 7          2   Month3 29.50702    Drug B Site 1</span></span>
<span><span class="co">#&gt; 8          2   Month6 28.66850    Drug B Site 2</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="basic-usage-simple-longitudinal-plot">Basic Usage: Simple Longitudinal Plot<a class="anchor" aria-label="anchor" href="#basic-usage-simple-longitudinal-plot"></a>
</h3>
<p>Let’s start with the most basic usage of <code>zzlongplot</code>:
creating a simple plot of outcome over time.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic plot showing outcome over time</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">continuous_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">visit_time</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Outcome Over Time"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Weeks"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Outcome Measure"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/basic_plot-1.png" width="960"></p>
<p>In this example, we’ve used a simple formula
<code>outcome ~ visit_time</code> to specify that we want to plot the
outcome variable on the y-axis against the visit time on the x-axis.
Since we haven’t specified a grouping variable, all subjects are plotted
together.</p>
</div>
<div class="section level3">
<h3 id="adding-grouping-with-formula-syntax">Adding Grouping with Formula Syntax<a class="anchor" aria-label="anchor" href="#adding-grouping-with-formula-syntax"></a>
</h3>
<p>Now, let’s use the formula syntax to add grouping by treatment:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with grouping by treatment</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">continuous_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">visit_time</span> <span class="op">|</span> <span class="va">group</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Effect Over Time"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Weeks"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Outcome Measure"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/group_plot-1.png" width="960"></p>
<p>The formula <code>outcome ~ visit_time | group</code> tells
<code>zzlongplot</code> to: - Plot outcome on the y-axis - Use
visit_time for the x-axis - Group and color the lines by the “group”
variable</p>
<p>This makes it easy to compare trajectories between different
treatment groups.</p>
</div>
<div class="section level3">
<h3 id="visualizing-change-from-baseline">Visualizing Change from Baseline<a class="anchor" aria-label="anchor" href="#visualizing-change-from-baseline"></a>
</h3>
<p>One of the key features of <code>zzlongplot</code> is the ability to
visualize changes from baseline. Let’s create a plot showing both
observed values and changes:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot both observed values and change from baseline</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">continuous_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">visit_time</span> <span class="op">|</span> <span class="va">group</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      plot_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Observed Outcomes"</span>,</span>
<span>      title2 <span class="op">=</span> <span class="st">"Change from Baseline"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Weeks"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Outcome Measure"</span>,</span>
<span>      ylab2 <span class="op">=</span> <span class="st">"Change in Outcome"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/change_plot-1.png" width="960"></p>
<p>By setting <code>plot_type = "both"</code>, we get two side-by-side
plots: 1. The left plot shows the observed values 2. The right plot
shows the change from baseline</p>
<p>This makes it easy to see both the absolute measurements and the
relative changes in one figure.</p>
</div>
<div class="section level3">
<h3 id="working-with-categorical-time-points">Working with Categorical Time Points<a class="anchor" aria-label="anchor" href="#working-with-categorical-time-points"></a>
</h3>
<p>Now let’s demonstrate how <code>zzlongplot</code> handles categorical
time points using our second dataset:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with categorical time points</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Comparison"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/categorical_plot-1.png" width="960"></p>
<p>Notice that we’ve specified <code>baseline_value = "Baseline"</code>
to indicate the baseline level of our categorical variable. The formula
syntax remains the same regardless of whether the x-variable is
continuous or categorical.</p>
</div>
<div class="section level3">
<h3 id="adding-facets-with-formula-syntax">Adding Facets with Formula Syntax<a class="anchor" aria-label="anchor" href="#adding-facets-with-formula-syntax"></a>
</h3>
<p><code>zzlongplot</code> supports faceting to examine how effects
might differ across another variable. Let’s add faceting by site:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with faceting by site</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      facet_form <span class="op">=</span> <span class="op">~</span> <span class="va">site</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Comparison by Site"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/facet_plot-1.png" width="960"></p>
<p>The <code>facet_form = ~ site</code> syntax tells
<code>zzlongplot</code> to create separate panels for each level of the
“site” variable. This allows for easy comparison of treatment effects
across different sites.</p>
</div>
<div class="section level3">
<h3 id="customizing-error-representation">Customizing Error Representation<a class="anchor" aria-label="anchor" href="#customizing-error-representation"></a>
</h3>
<p>By default, <code>zzlongplot</code> uses error bars to represent
standard error. We can switch to confidence bands using the
<code>error_type</code> parameter:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using confidence bands instead of error bars</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      error_type <span class="op">=</span> <span class="st">"band"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Comparison with Confidence Bands"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/error_bands-1.png" width="960"></p>
<p>Confidence bands can sometimes provide a cleaner visualization,
especially when multiple groups are being compared.</p>
</div>
<div class="section level3">
<h3 id="using-color-palettes">Using Color Palettes<a class="anchor" aria-label="anchor" href="#using-color-palettes"></a>
</h3>
<p><code>zzlongplot</code> includes support for custom color palettes.
Let’s define our own colorblind-friendly palette:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a colorblind-friendly palette manually</span></span>
<span><span class="co"># These colors are based on the ColorBrewer "Dark2" palette</span></span>
<span><span class="va">custom_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#1B9E77"</span>, <span class="st">"#D95F02"</span>, <span class="st">"#7570B3"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply custom colors to the plot</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      color_palette <span class="op">=</span> <span class="va">custom_colors</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Comparison with Custom Colors"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/color_palette-1.png" width="960"></p>
<p>Note: The full version of the <code>zzlongplot</code> package
includes a <code><a href="../reference/get_colorblind_palette.html">get_colorblind_palette()</a></code> function that
automatically generates appropriate color schemes, but we’re using a
manual definition here for demonstration purposes.</p>
<p>This ensures that your visualizations are accessible to readers with
color vision deficiencies.</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-usage-examples">Advanced Usage Examples<a class="anchor" aria-label="anchor" href="#advanced-usage-examples"></a>
</h2>
<p>Let’s explore some more advanced use cases that demonstrate the
flexibility of <code>zzlongplot</code>.</p>
<div class="section level3">
<h3 id="complex-formula-multiple-grouping-variables">Complex Formula: Multiple Grouping Variables<a class="anchor" aria-label="anchor" href="#complex-formula-multiple-grouping-variables"></a>
</h3>
<p>The formula interface supports multiple grouping variables by
combining them with <code>+</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, add a secondary grouping variable to our data</span></span>
<span><span class="va">categorical_data</span><span class="op">$</span><span class="va">gender</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">categorical_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot with two grouping variables</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">gender</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment by Gender Interaction"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/multiple_groups-1.png" width="960"></p>
<p>The formula <code>score ~ visit | treatment + gender</code> creates
groups for each combination of treatment and gender, allowing us to
examine potential interactions between these variables.</p>
</div>
<div class="section level3">
<h3 id="multi-facet-formula">Multi-facet Formula<a class="anchor" aria-label="anchor" href="#multi-facet-formula"></a>
</h3>
<p>We can also use formulas to create complex faceting arrangements:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add another variable for faceting</span></span>
<span><span class="va">categorical_data</span><span class="op">$</span><span class="va">age_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Young"</span>, <span class="st">"Middle"</span>, <span class="st">"Elder"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">categorical_data</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a plot with multi-dimensional faceting</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">categorical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">score</span> <span class="op">~</span> <span class="va">visit</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      facet_form <span class="op">=</span> <span class="va">age_group</span> <span class="op">~</span> <span class="va">site</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="st">"Baseline"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Treatment Effects Across Age Groups and Sites"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Visit"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Score"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/multi_facet-1.png" width="960"></p>
<p>The <code>facet_form = age_group ~ site</code> syntax creates a grid
of panels with age groups as rows and sites as columns, allowing for a
comprehensive comparison across multiple dimensions.</p>
</div>
<div class="section level3">
<h3 id="custom-analysis-non-standard-baseline">Custom Analysis: Non-Standard Baseline<a class="anchor" aria-label="anchor" href="#custom-analysis-non-standard-baseline"></a>
</h3>
<p>Sometimes we might want to use a non-standard time point as our
baseline. <code>zzlongplot</code> makes this easy:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using a non-zero time point as baseline for continuous data</span></span>
<span><span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">continuous_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">visit_time</span> <span class="op">|</span> <span class="va">group</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="fl">4</span>,  <span class="co"># Using week 4 as baseline instead of week 0</span></span>
<span>      plot_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Outcomes (Week 4 as Baseline)"</span>,</span>
<span>      title2 <span class="op">=</span> <span class="st">"Change from Week 4"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Weeks"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Outcome Measure"</span>,</span>
<span>      ylab2 <span class="op">=</span> <span class="st">"Change from Week 4"</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/custom_baseline-1.png" width="960"></p>
<p>By setting <code>baseline_value = 4</code>, we’re using Week 4 as our
reference point rather than the usual Week 0. This flexibility allows
for various analysis approaches, such as examining how later
measurements compare to mid-study values.</p>
</div>
<div class="section level3">
<h3 id="clinical-trial-example-with-responder-analysis">Clinical Trial Example with Responder Analysis<a class="anchor" aria-label="anchor" href="#clinical-trial-example-with-responder-analysis"></a>
</h3>
<p>Let’s demonstrate a more complex example typical in clinical trials,
where we might want to analyze both raw scores and responder status:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a clinical trial dataset</span></span>
<span><span class="va">clinical_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  subject_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">60</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  visit_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span><span class="op">)</span>, times <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>,</span>
<span>  pain_score <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  responder <span class="op">=</span> <span class="cn">NA</span>,  <span class="co"># Will define responders as those with ≥30% improvement</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Active"</span>, <span class="st">"Control"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>,</span>
<span>  site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Site A"</span>, <span class="st">"Site B"</span>, <span class="st">"Site C"</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate pain scores (0-10 scale, higher = worse pain)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">subject</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">subject_id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">clinical_data</span><span class="op">$</span><span class="va">subject_id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">baseline</span> <span class="op">&lt;-</span> <span class="fl">7</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># Most patients start with severe pain</span></span>
<span>  </span>
<span>  <span class="co"># Different effects for different treatments</span></span>
<span>  <span class="va">is_active</span> <span class="op">&lt;-</span> <span class="va">clinical_data</span><span class="op">$</span><span class="va">treatment</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Active"</span></span>
<span>  </span>
<span>  <span class="co"># Effect sizes (pain reduction)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">is_active</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3.5</span><span class="op">)</span>  <span class="co"># Stronger pain reduction</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">effect_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span><span class="op">)</span>  <span class="co"># Weaker pain reduction</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Add individual trajectory with some random noise</span></span>
<span>  <span class="va">clinical_data</span><span class="op">$</span><span class="va">pain_score</span><span class="op">[</span><span class="va">subject_rows</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">baseline</span> <span class="op">-</span> <span class="va">effect_size</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate responder status (≥30% improvement from baseline)</span></span>
<span><span class="va">clinical_data</span> <span class="op">&lt;-</span> <span class="va">clinical_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">subject_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    baseline_score <span class="op">=</span> <span class="va">pain_score</span><span class="op">[</span><span class="va">visit_week</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>,</span>
<span>    pct_improvement <span class="op">=</span> <span class="op">(</span><span class="va">baseline_score</span> <span class="op">-</span> <span class="va">pain_score</span><span class="op">)</span> <span class="op">/</span> <span class="va">baseline_score</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    responder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pct_improvement</span> <span class="op">&gt;=</span> <span class="fl">30</span>, <span class="st">"Responder"</span>, <span class="st">"Non-responder"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot pain scores over time</span></span>
<span><span class="va">pain_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lplot.html">lplot</a></span><span class="op">(</span><span class="va">clinical_data</span>, </span>
<span>      form <span class="op">=</span> <span class="va">pain_score</span> <span class="op">~</span> <span class="va">visit_week</span> <span class="op">|</span> <span class="va">treatment</span>,</span>
<span>      cluster_var <span class="op">=</span> <span class="st">"subject_id"</span>,</span>
<span>      baseline_value <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      title <span class="op">=</span> <span class="st">"Pain Score Over Time"</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>      ylab <span class="op">=</span> <span class="st">"Pain Score (0-10)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate responder percentages</span></span>
<span><span class="va">responder_data</span> <span class="op">&lt;-</span> <span class="va">clinical_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">visit_week</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Exclude baseline</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">visit_week</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    n_subjects <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    n_responders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">responder</span> <span class="op">==</span> <span class="st">"Responder"</span><span class="op">)</span>,</span>
<span>    pct_responders <span class="op">=</span> <span class="va">n_responders</span> <span class="op">/</span> <span class="va">n_subjects</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a custom plot for responder rates</span></span>
<span><span class="va">responder_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">responder_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">visit_week</span>, y <span class="op">=</span> <span class="va">pct_responders</span>, color <span class="op">=</span> <span class="va">treatment</span>, group <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Responder Rates (≥30% Improvement)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Percent of Responders"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Treatment"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the plots using patchwork</span></span>
<span><span class="va">pain_plot</span> <span class="op">+</span> <span class="va">responder_plot</span> <span class="op">+</span> <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="zzlongplot_introduction_files/figure-html/clinical_trial-1.png" width="960"></p>
<p>This example demonstrates how <code>zzlongplot</code> can be
integrated into a more comprehensive analysis workflow, combining
standard longitudinal visualizations with custom plots for derived
endpoints.</p>
</div>
</div>
<div class="section level2">
<h2 id="formula-syntax-reference">Formula Syntax Reference<a class="anchor" aria-label="anchor" href="#formula-syntax-reference"></a>
</h2>
<p>The <code>zzlongplot</code> package uses a formula-based interface
that follows these patterns:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Basic formula</strong>: <code>y ~ x</code>
<ul>
<li>
<code>y</code>: The outcome or dependent variable to plot on the
y-axis</li>
<li>
<code>x</code>: The time or visit variable to plot on the
x-axis</li>
</ul>
</li>
<li>
<strong>With grouping</strong>: <code>y ~ x | group</code>
<ul>
<li>
<code>group</code>: A variable used to group and color the data</li>
</ul>
</li>
<li>
<strong>With multiple grouping variables</strong>:
<code>y ~ x | group1 + group2</code>
<ul>
<li>Creates groups for each combination of the grouping variables</li>
</ul>
</li>
<li>
<strong>With faceting</strong>: Use the separate
<code>facet_form</code> parameter
<ul>
<li>
<code>~ facet_var</code>: Creates columns for each level of
<code>facet_var</code>
</li>
<li>
<code>facet_var ~</code>: Creates rows for each level of
<code>facet_var</code>
</li>
<li>
<code>facet_row ~ facet_col</code>: Creates a grid with rows and
columns</li>
</ul>
</li>
</ol>
<p>This formula syntax is designed to be intuitive for R users familiar
with model formulas, while providing the flexibility needed for complex
visualization scenarios.</p>
</div>
<div class="section level2">
<h2 id="best-practices-for-longitudinal-visualization">Best Practices for Longitudinal Visualization<a class="anchor" aria-label="anchor" href="#best-practices-for-longitudinal-visualization"></a>
</h2>
<p>When using <code>zzlongplot</code> for your research, consider these
best practices:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Choose meaningful baselines</strong>: The choice of
baseline can significantly impact the interpretation of change
values.</p></li>
<li><p><strong>Consider both observed and change plots</strong>:
Observed values show absolute measurements, while change plots highlight
relative differences. Both provide valuable insights.</p></li>
<li><p><strong>Use appropriate error representation</strong>: Error bars
work well for categorical x-variables with few levels, while confidence
bands may be preferable for continuous x-variables or when comparing
many groups.</p></li>
<li><p><strong>Apply colorblind-friendly palettes</strong>: Ensure your
visualizations are accessible to all readers by using appropriate color
palettes, such as the ones from the ColorBrewer package (e.g., “Dark2”
for categorical data).</p></li>
<li><p><strong>Leverage faceting judiciously</strong>: Faceting can
reveal important patterns but can also make plots complex. Use it when
comparing across important categorical variables.</p></li>
<li><p><strong>Provide clear labels and titles</strong>: Ensure your
plots have informative axis labels, titles, and legends to guide
interpretation.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>zzlongplot</code> package provides a flexible and powerful
framework for visualizing longitudinal data in R. Its formula-based
interface, combined with comprehensive options for customization, makes
it an invaluable tool for researchers working with repeated measures
data across various fields.</p>
<p>By following the examples and guidelines in this vignette, you can
create publication-quality visualizations that effectively communicate
patterns, trends, and group differences in your longitudinal data.</p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: America/Los_Angeles</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] patchwork_1.3.1       ggplot2_3.5.2         dplyr_1.1.4          </span></span>
<span><span class="co">#&gt; [4] zzlongplot_0.0.0.1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.6       jsonlite_2.0.0     compiler_4.5.1     tidyselect_1.2.1  </span></span>
<span><span class="co">#&gt;  [5] jquerylib_0.1.4    systemfonts_1.2.3  scales_1.4.0       textshaping_1.0.1 </span></span>
<span><span class="co">#&gt;  [9] yaml_2.3.10        fastmap_1.2.0      R6_2.6.1           labeling_0.4.3    </span></span>
<span><span class="co">#&gt; [13] generics_0.1.4     knitr_1.50         htmlwidgets_1.6.4  conflicted_1.2.0  </span></span>
<span><span class="co">#&gt; [17] tibble_3.3.0       desc_1.4.3         bslib_0.9.0        pillar_1.11.0     </span></span>
<span><span class="co">#&gt; [21] RColorBrewer_1.1-3 rlang_1.1.6        cachem_1.1.0       xfun_0.52         </span></span>
<span><span class="co">#&gt; [25] fs_1.6.6           sass_0.4.10        memoise_2.0.1      cli_3.6.5         </span></span>
<span><span class="co">#&gt; [29] withr_3.0.2        pkgdown_2.1.3      magrittr_2.0.3     digest_0.6.37     </span></span>
<span><span class="co">#&gt; [33] grid_4.5.1         lifecycle_1.0.4    vctrs_0.6.5        evaluate_1.0.4    </span></span>
<span><span class="co">#&gt; [37] glue_1.8.0         farver_2.1.2       ragg_1.4.0         rmarkdown_2.29    </span></span>
<span><span class="co">#&gt; [41] tools_4.5.1        pkgconfig_2.0.3    htmltools_0.5.8.1</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ronald (Ryy) G Thomas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
