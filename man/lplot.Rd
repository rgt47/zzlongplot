% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lplot.R
\name{lplot}
\alias{lplot}
\title{Create Longitudinal Plots for Observed and Change Values}
\usage{
lplot(
  df,
  form,
  facet_form = NULL,
  cluster_var = "subject_id",
  baseline_value = "baseline",
  xlab = "visit",
  ylab = "measure",
  ylab2 = "measure change",
  title = "Observed Values",
  title2 = "Change from Baseline",
  subtitle = "",
  subtitle2 = "",
  caption = "",
  caption2 = "",
  plot_type = "obs",
  error_type = "bar",
  jitter_width = 0.15,
  color_palette = NULL,
  clinical_mode = FALSE,
  treatment_colors = NULL,
  confidence_interval = NULL,
  summary_statistic = "mean",
  show_sample_sizes = FALSE,
  visit_windows = NULL,
  theme = NULL,
  publication_ready = FALSE,
  statistical_annotations = FALSE,
  reference_lines = NULL,
  ribbon_alpha = 0.2,
  ribbon_fill = NULL
)
}
\arguments{
\item{df}{A data frame containing the data to be plotted.}

\item{form}{A formula specifying the variables for the x-axis, grouping, and
y-axis. Format: \code{y ~ x | group}.}

\item{facet_form}{A formula specifying the variables for faceting. Format:
\code{facet_y ~ facet_x}. Default is \code{NULL}.}

\item{cluster_var}{A character string specifying the name of the cluster
variable for grouping within subjects (typically a participant or subject ID).}

\item{baseline_value}{The baseline value of the x variable, used to calculate changes.
For categorical x variables, this is treated as a level. For continuous x
variables, this is treated as a numeric value.}

\item{xlab}{Label for the x-axis.}

\item{ylab}{Label for the y-axis of the observed values plot.}

\item{ylab2}{Label for the y-axis of the change values plot.}

\item{title}{Title for the observed values plot.}

\item{title2}{Title for the change values plot.}

\item{subtitle}{Subtitle for the observed values plot.}

\item{subtitle2}{Subtitle for the change values plot.}

\item{caption}{Caption for the observed values plot.}

\item{caption2}{Caption for the change values plot.}

\item{plot_type}{Type of plot to return. Options are \code{"obs"} (observed values),
\code{"change"} (change values), or \code{"both"} for combined plots.}

\item{error_type}{Type of error representation. Options are \code{"bar"} for error bars
(vertical lines showing standard error) or \code{"band"} for error ribbons
(shaded areas around the line).}

\item{jitter_width}{Numeric. Width of horizontal jitter for error bars when
multiple groups are present. Default is 0.1. Set to 0 to disable jittering.
Only applies when error_type = "bar".}

\item{color_palette}{Optional vector of colors to use for groups. If NULL,
default ggplot colors are used.}

\item{clinical_mode}{Logical. If TRUE, enables clinical trial defaults
(95\% CI, sample sizes, clinical colors). Default is FALSE.}

\item{treatment_colors}{Character. Predefined color scheme for treatments.
Options: "standard" (placebo=grey, active=colors), or NULL.}

\item{confidence_interval}{Numeric. Confidence level for error bounds
(e.g., 0.95 for 95\% CI). If NULL, uses standard error.}

\item{summary_statistic}{Character. Type of summary statistic to calculate.
Options: "mean" (mean ± CI/SE), "mean_se" (mean ± SE), "median" (median + IQR),
or "boxplot" (boxplot summary with quartiles). Default is "mean".}

\item{show_sample_sizes}{Logical. If TRUE, shows sample sizes at each timepoint.}

\item{visit_windows}{List. Named list defining visit windows for grouping
(e.g., list("Week 4" = c(22, 35))).}

\item{theme}{Character. Predefined publication theme with matching colors.
Options: "nejm", "nature", "lancet", "jama", "science", "jco", "fda", or NULL.
Applies both typography/layout AND journal-specific color palette automatically.}

\item{publication_ready}{Logical. If TRUE, applies publication-ready defaults
(professional theme, proper typography, clean styling).}

\item{statistical_annotations}{Logical. If TRUE, adds p-values and significance
indicators to the plots.}

\item{reference_lines}{List of reference line specifications. Each should be a
list with 'value', 'axis' ("x"/"y"), 'color', 'linetype', etc.}

\item{ribbon_alpha}{Numeric. Transparency level for ribbon/band error representations.
Values from 0 (fully transparent) to 1 (fully opaque). Default is 0.2.}

\item{ribbon_fill}{Character. Custom fill color for ribbons. If NULL, uses group colors.}
}
\value{
A ggplot2 object or a combination of objects representing the requested
plots.
}
\description{
Generates flexible plots for longitudinal data, showing either
observed values, change from baseline, or both. Supports grouping and faceting.
}
\examples{
# Example with continuous x variable
df <- data.frame(
  subject_id = rep(1:10, each = 3),
  visit = rep(c(0, 1, 2), times = 10),
  measure = rnorm(30, mean = 50, sd = 10),
  group = rep(c("Treatment", "Control"), length.out = 30)
)
# Plot observed values by visit and group
lplot(df, measure ~ visit | group, baseline_value = 0, 
      cluster_var = "subject_id")

# Plot with jittered error bars for better group separation
lplot(df, measure ~ visit | group, baseline_value = 0, 
      cluster_var = "subject_id", jitter_width = 0.15)

# Plot using median and IQR instead of mean and CI
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", summary_statistic = "median")

# Plot using mean ± SE (standard error)
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", summary_statistic = "mean_se")

# Plot using boxplot summary (quartiles + whiskers)
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", summary_statistic = "boxplot")

# Customize ribbon appearance
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", error_type = "band", 
      ribbon_alpha = 0.4, ribbon_fill = "lightblue")

\dontrun{
# Apply complete journal styling (theme + colors) with single parameter
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", theme = "nejm")    # NEJM theme + colors
lplot(df, measure ~ visit | group, baseline_value = 0,
      cluster_var = "subject_id", theme = "nature")  # Nature theme + colors
}

# Example with categorical x variable
df2 <- data.frame(
  subject_id = rep(1:10, each = 3),
  visit = rep(c("baseline", "month1", "month2"), times = 10),
  measure = rnorm(30, mean = 50, sd = 10),
  group = rep(c("Treatment", "Control"), length.out = 30)
)
# Plot both observed and change values
lplot(df2, measure ~ visit | group, baseline_value = "baseline",
      cluster_var = "subject_id", plot_type = "both",
      title = "Treatment Response", title2 = "Change from Baseline")

\dontrun{
# Clinical trial example with CDISC variables
clinical_data <- data.frame(
  USUBJID = rep(paste0("001-", sprintf("\%03d", 1:20)), each = 4),
  AVISITN = rep(c(0, 1, 2, 3), times = 20),
  AVAL = rnorm(80, mean = c(50, 48, 45, 42), sd = 8),
  TRT01P = rep(c("Placebo", "Drug A", "Drug B"), length.out = 80)
)

# Clinical mode with automatic CDISC handling
lplot(clinical_data, AVAL ~ AVISITN | TRT01P, 
      cluster_var = "USUBJID", baseline_value = 0,
      clinical_mode = TRUE, plot_type = "both",
      title = "Clinical Trial Results")
}

}
